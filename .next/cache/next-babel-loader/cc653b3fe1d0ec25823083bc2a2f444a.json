{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/Users/hsyun/programming/web/full_project/doctor-MBTI/pages/loading.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch } from \"react-redux\";\nimport { Typography, Row, Col } from \"antd\";\nimport { useSelector } from \"react-redux\";\nvar Text = Typography.Text;\nimport { ADD_URL } from \"../reducers/answer\";\nimport { MAKE_DIRECT_FALSE } from \"../reducers/answer\";\nimport db from \"../back/firestore\";\nimport storage from \"../back/cloudStorage\";\nimport { v4 as uuid } from \"uuid\";\nimport calculator from \"../back/calculator\";\nimport result from \"../assets/result.json\";\nimport { WidthDiv } from \"../assets/css/style_result\";\nimport { Spinner } from \"react-activity\";\n\nvar Loading = function Loading() {\n  _s();\n\n  var router = useRouter();\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.answer;\n  }),\n      ans = _useSelector.ans;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.answer;\n  }),\n      url = _useSelector2.url;\n\n  var _useState = useState(null),\n      screenshotUrl = _useState[0],\n      setScreenshotUrl = _useState[1];\n\n  var _useState2 = useState(null),\n      thumbUrl = _useState2[0],\n      setThumbUrl = _useState2[1];\n\n  var _useState3 = useState(null),\n      id = _useState3[0],\n      setId = _useState3[1];\n\n  var _useState4 = useState(null),\n      v = _useState4[0],\n      setV = _useState4[1];\n\n  useEffect(function () {\n    if (ans) {\n      console.log(ans);\n      setId(calculator[ans]);\n    } else {\n      console.log(\"id is null\");\n      router.push(\"/result/\".concat(calculator([])));\n    }\n  }, [ans]);\n  useEffect(function () {\n    setV(result[id]);\n    var now = new Date();\n    var uid = uuid();\n    var userObj = {\n      answer: ans,\n      type: id,\n      created_at: now,\n      updated_at: now\n    };\n    db.collection(\"results\").doc(uid).set(userObj).then(function (res) {})[\"catch\"](function (error) {\n      alert(\"error: \" + error.message);\n      console.log(error);\n    });\n  }, [id]);\n  useEffect(function () {\n    if (v) {\n      storage.ref().child(v[\"screenshot\"]).getDownloadURL().then(function (url) {\n        setScreenshotUrl(url);\n      })[\"catch\"](function (err) {\n        return;\n      });\n      storage.ref().child(v[\"thumbnail\"]).getDownloadURL().then(function (url) {\n        setThumbUrl(url);\n      })[\"catch\"](function (err) {\n        return;\n      });\n    }\n  }, [v]);\n  useEffect(function () {\n    if (screenshotUrl && thumbUrl) {\n      dispatch({\n        type: ADD_URL,\n        data: {\n          screenshotUrl: screenshotUrl,\n          thumbUrl: thumbUrl\n        }\n      });\n    }\n  }, [screenshotUrl, thumbUrl]);\n  useEffect(function () {\n    dispatch({\n      type: MAKE_DIRECT_FALSE\n    });\n    router.push(\"/result/\".concat(id));\n  }, [url[\"thumbUrl\"]]);\n  return __jsx(React.Fragment, null, __jsx(Row, {\n    justify: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 4\n    }\n  }, __jsx(Col, {\n    xs: 16,\n    sm: 14,\n    md: 10,\n    lg: 8,\n    xl: 8,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }\n  }, __jsx(WidthDiv, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 6\n    }\n  }, __jsx(Spinner, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  })))), __jsx(Row, {\n    justify: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 4\n    }\n  }, __jsx(Col, {\n    xs: 16,\n    sm: 14,\n    md: 10,\n    lg: 8,\n    xl: 8,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }\n  }, __jsx(Text, {\n    style: {\n      textAlign: \"center\",\n      display: \"block\",\n      marginTop: \"30px\",\n      fontSize: \"20px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 6\n    }\n  }, \"\\uBD84\\uC11D\\uC911..\"))));\n};\n\n_s(Loading, \"X8UjRNxc0DjzInVccNG29FFd/Lg=\", false, function () {\n  return [useRouter, useDispatch, useSelector, useSelector];\n});\n\n_c = Loading;\nexport default Loading;\n\nvar _c;\n\n$RefreshReg$(_c, \"Loading\");","map":{"version":3,"sources":["/Users/hsyun/programming/web/full_project/doctor-MBTI/pages/loading.js"],"names":["React","useEffect","useState","useRouter","useDispatch","Typography","Row","Col","useSelector","Text","ADD_URL","MAKE_DIRECT_FALSE","db","storage","v4","uuid","calculator","result","WidthDiv","Spinner","Loading","router","dispatch","state","answer","ans","url","screenshotUrl","setScreenshotUrl","thumbUrl","setThumbUrl","id","setId","v","setV","console","log","push","concat","now","Date","uid","userObj","type","created_at","updated_at","collection","doc","set","then","res","error","alert","message","ref","child","getDownloadURL","err","data","textAlign","display","marginTop","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch } from \"react-redux\";\nimport { Typography, Row, Col } from \"antd\";\nimport { useSelector } from \"react-redux\";\nconst { Text } = Typography;\n\nimport { ADD_URL } from \"../reducers/answer\";\nimport { MAKE_DIRECT_FALSE } from \"../reducers/answer\";\n\nimport db from \"../back/firestore\";\nimport storage from \"../back/cloudStorage\";\nimport { v4 as uuid } from \"uuid\";\nimport calculator from \"../back/calculator\";\nimport result from \"../assets/result.json\";\n\nimport { WidthDiv } from \"../assets/css/style_result\";\nimport { Spinner } from \"react-activity\";\n\nconst Loading = () => {\n\tconst router = useRouter();\n\tconst dispatch = useDispatch();\n\tconst { ans } = useSelector((state) => state.answer);\n\tconst { url } = useSelector((state) => state.answer);\n\n\tconst [screenshotUrl, setScreenshotUrl] = useState(null);\n\tconst [thumbUrl, setThumbUrl] = useState(null);\n\tconst [id, setId] = useState(null);\n\tconst [v, setV] = useState(null);\n\n\tuseEffect(() => {\n\t\tif (ans) {\n\t\t\tconsole.log(ans);\n\t\t\tsetId(calculator[ans]);\n\t\t} else {\n\t\t\tconsole.log(\"id is null\");\n\t\t\trouter.push(\"/result/\".concat(calculator([])));\n\t\t}\n\t}, [ans]);\n\n\tuseEffect(() => {\n\t\tsetV(result[id]);\n\t\tconst now = new Date();\n\t\tconst uid = uuid();\n\n\t\tconst userObj = {\n\t\t\tanswer: ans,\n\t\t\ttype: id,\n\t\t\tcreated_at: now,\n\t\t\tupdated_at: now,\n\t\t};\n\n\t\tdb.collection(\"results\")\n\t\t\t.doc(uid)\n\t\t\t.set(userObj)\n\t\t\t.then((res) => {})\n\t\t\t.catch((error) => {\n\t\t\t\talert(\"error: \" + error.message);\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t}, [id]);\n\n\tuseEffect(() => {\n\t\tif (v) {\n\t\t\tstorage\n\t\t\t\t.ref()\n\t\t\t\t.child(v[\"screenshot\"])\n\t\t\t\t.getDownloadURL()\n\t\t\t\t.then((url) => {\n\t\t\t\t\tsetScreenshotUrl(url);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\treturn;\n\t\t\t\t});\n\n\t\t\tstorage\n\t\t\t\t.ref()\n\t\t\t\t.child(v[\"thumbnail\"])\n\t\t\t\t.getDownloadURL()\n\t\t\t\t.then((url) => {\n\t\t\t\t\tsetThumbUrl(url);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\treturn;\n\t\t\t\t});\n\t\t}\n\t}, [v]);\n\n\tuseEffect(() => {\n\t\tif (screenshotUrl && thumbUrl) {\n\t\t\tdispatch({\n\t\t\t\ttype: ADD_URL,\n\t\t\t\tdata: {\n\t\t\t\t\tscreenshotUrl: screenshotUrl,\n\t\t\t\t\tthumbUrl: thumbUrl,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}, [screenshotUrl, thumbUrl]);\n\n\tuseEffect(() => {\n\t\tdispatch({\n\t\t\ttype: MAKE_DIRECT_FALSE,\n\t\t});\n\n\t\trouter.push(\"/result/\".concat(id));\n\t}, [url[\"thumbUrl\"]]);\n\n\treturn (\n\t\t<>\n\t\t\t<Row justify=\"center\">\n\t\t\t\t<Col xs={16} sm={14} md={10} lg={8} xl={8}>\n\t\t\t\t\t<WidthDiv>\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</WidthDiv>\n\t\t\t\t</Col>\n\t\t\t</Row>\n\t\t\t<Row justify=\"center\">\n\t\t\t\t<Col xs={16} sm={14} md={10} lg={8} xl={8}>\n\t\t\t\t\t<Text\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\ttextAlign: \"center\",\n\t\t\t\t\t\t\tdisplay: \"block\",\n\t\t\t\t\t\t\tmarginTop: \"30px\",\n\t\t\t\t\t\t\tfontSize: \"20px\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t분석중..\n\t\t\t\t\t</Text>\n\t\t\t\t</Col>\n\t\t\t</Row>\n\t\t</>\n\t);\n};\n\nexport default Loading;\n"]},"metadata":{},"sourceType":"module"}